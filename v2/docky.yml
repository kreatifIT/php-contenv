version: 2

project:
  name: dockyapp
  network: optimesh              # becomes ${NETWORK_NAME}

php:
  version: "8.4"                 # ${PHP_VERSION}
  server: nginx                  # ${PHP_SERVER} : apache|nginx|frankenphp
  target: development            # ${PHP_TARGET} : development|production

# base app knobs the stub will use
app:
  ports: ["8081:80"]
  env:
    PUID: 1000
    PGID: 1000
    XDEBUG_MODE: "off"
    XDEBUG_CLIENT_HOST: "host.docker.internal"
  volumes:
    - .:/var/www/html

# choose stubs to include (order matters; app first is fine)
stubs:
  - app
  - mysql
  - typesense

# overlays to activate at runtime (mounted via OVERLAY_DIRS)
overlays:
  - queue-worker
  - locales

# defaults for placeholders used by stubs
vars:
  NETWORK_NAME: "optimesh"
  PHP_VERSION: "8.4"
  PHP_SERVER: "nginx"
  PHP_TARGET: "development"
  DOCKER_SUBMODULE_DIR: ".docker/v2"

  # app stub
  APP_SERVICE_NAME: "docky_app"
  APP_PORT: "8081"
  VITE_PORT: "5170"

  # mysql stub
  DB_DATABASE: "app"
  DB_USERNAME: "user"
  DB_PASSWORD: "password"
  DB_ROOT_PASSWORD: "secret"
  FORWARD_DB_PORT: "3306"

  # typesense stub
  TYPESENSE_API_KEY: "changeme"
  FORWARD_TYPESENSE_PORT: "8108"

  DOCKER_SUBMODULE_DIR: ".docker/v2"
  DOCKER_PROJECT_OVERLAYS_DIR: ".docker/overlays"

OPTIONS:
  PHP_VERSIONS:
    - "8.4"
    - "8.3"
    - "8.2"
    - "8.1"
  PHP_SERVERS:
    - apache
    - nginx
    - frankenphp
  PHP_TARGETS:
    - development
    - production
  DB_ENGINES:
    - mysql
    - postgres
    - mariadb
  CACHES:
    - redis
    - memcached
  SEARCH_ENGINES:
    - elasticsearch
    - typesense
  MESSAGE_QUEUES:
    - rabbitmq
    - beanstalkd
    - redis
  OVERLAYS:
    - queue-worker
    - locales
    - adminer
    - mailhog
    - selenium
    - minio
    - mailpit
    - phpmyadmin
    - pgadmin
    - watchtower
    - custom-scripts
    - x11vnc
    - code-server

